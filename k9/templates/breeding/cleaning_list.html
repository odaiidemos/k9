{% extends "base.html" %}

{% block title %}النظافة (البيئة/القفص) - نظام K9{% endblock %}

{% block content %}
<div class="container-fluid mt-4" dir="rtl">
    <div class="row">
        <div class="col-md-12">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h2><i class="fas fa-broom me-2"></i>النظافة (البيئة/القفص)</h2>
                <a href="{{ url_for('main.cleaning_new') }}" class="btn btn-primary">
                    <i class="fas fa-plus"></i> إضافة سجل نظافة
                </a>
            </div>

            <!-- Filters -->
            <div class="card mb-4">
                <div class="card-header">
                    <h5><i class="fas fa-filter me-2"></i>المرشحات</h5>
                </div>
                <div class="card-body">
                    <form id="filterForm" class="row g-3">
                        <div class="col-md-3">
                            <label class="form-label">المشروع</label>
                            <select class="form-select" id="projectFilter" name="project_id">
                                <option value="">جميع المشاريع</option>
                            </select>
                        </div>
                        <div class="col-md-3">
                            <label class="form-label">الكلب</label>
                            <select class="form-select" id="dogFilter" name="dog_id">
                                <option value="">جميع الكلاب</option>
                            </select>
                        </div>
                        <div class="col-md-2">
                            <label class="form-label">من تاريخ</label>
                            <input type="date" class="form-control" id="dateFrom" name="date_from">
                        </div>
                        <div class="col-md-2">
                            <label class="form-label">إلى تاريخ</label>
                            <input type="date" class="form-control" id="dateTo" name="date_to">
                        </div>
                        <div class="col-md-2">
                            <button type="submit" class="btn btn-success">
                                <i class="fas fa-search"></i> بحث
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- KPI Cards -->
            <div class="row mb-4" id="kpiCards">
                <div class="col-md-2">
                    <div class="card bg-light">
                        <div class="card-body text-center">
                            <h6>إجمالي السجلات</h6>
                            <h4 id="totalCount">0</h4>
                        </div>
                    </div>
                </div>
                <div class="col-md-2">
                    <div class="card bg-info text-white">
                        <div class="card-body text-center">
                            <h6>تنظيف البيت</h6>
                            <h4 id="cleanedCount">0</h4>
                        </div>
                    </div>
                </div>
                <div class="col-md-2">
                    <div class="card bg-primary text-white">
                        <div class="card-body text-center">
                            <h6>غسل البيت</h6>
                            <h4 id="washedCount">0</h4>
                        </div>
                    </div>
                </div>
                <div class="col-md-2">
                    <div class="card bg-success text-white">
                        <div class="card-body text-center">
                            <h6>تعقيم البيت</h6>
                            <h4 id="disinfectedCount">0</h4>
                        </div>
                    </div>
                </div>
                <div class="col-md-2">
                    <div class="card bg-warning text-dark">
                        <div class="card-body text-center">
                            <h6>مطلوب غسيل</h6>
                            <h4 id="dueWashCount">0</h4>
                        </div>
                    </div>
                </div>
                <div class="col-md-2">
                    <div class="card bg-danger text-white">
                        <div class="card-body text-center">
                            <h6>مطلوب تعقيم</h6>
                            <h4 id="dueDisinfectCount">0</h4>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Data Table -->
            <div class="card">
                <div class="card-body">
                    <div id="loadingIndicator" class="text-center p-3">
                        <div class="spinner-border" role="status">
                            <span class="visually-hidden">جاري التحميل...</span>
                        </div>
                    </div>
                    
                    <div class="table-responsive" id="tableContainer" style="display: none;">
                        <table class="table table-striped table-hover">
                            <thead class="table-dark">
                                <tr style="direction: rtl;">
                                    <th>الإجراءات</th>
                                    <th>المشروع</th>
                                    <th>الكلب</th>
                                    <th>ملاحظات</th>
                                    <th>المواد المستخدمة</th>
                                    <th>وصف المجموعة</th>
                                    <th>تطهير بيوت مجموعة كلاب</th>
                                    <th>تعقيم البيت</th>
                                    <th>غسل البيت</th>
                                    <th>تنظيف البيت</th>
                                    <th>المكان البديل</th>
                                    <th>رقم البيت/القفص</th>
                                    <th>نوع المكان</th>
                                    <th>الوقت</th>
                                    <th>التاريخ</th>
                                </tr>
                            </thead>
                            <tbody id="cleaningTableBody">
                                <!-- Data will be populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>

                    <!-- Pagination -->
                    <nav aria-label="صفحات التنقل" id="paginationContainer" style="display: none;">
                        <ul class="pagination justify-content-center" id="paginationList">
                            <!-- Pagination will be populated by JavaScript -->
                        </ul>
                    </nav>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="{{ url_for('static', filename='js/cleaning.js') }}"></script>
{% endblock %}