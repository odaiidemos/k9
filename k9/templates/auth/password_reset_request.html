{% extends 'base.html' %}

{% block title %}إعادة تعيين كلمة المرور{% endblock %}

{% block content %}
<div class="auth-container">
    <div class="auth-card">
        <div class="auth-header">
            <h2>إعادة تعيين كلمة المرور</h2>
            {% if not success %}
            <p>أدخل عنوان بريدك الإلكتروني لتلقي تعليمات إعادة تعيين كلمة المرور</p>
            {% endif %}
        </div>
        
        {% if success %}
        {% if development_mode and reset_url %}
        <div class="alert alert-warning text-center">
            <i class="fas fa-exclamation-triangle fa-2x mb-3"></i>
            <h4>الوضع التطويري - تعذر إرسال البريد الإلكتروني</h4>
            <p>لم يتم تكوين خدمة البريد الإلكتروني. يمكنك استخدام الرابط التالي لإعادة تعيين كلمة المرور:</p>
            <div class="mt-3 p-3" style="background-color: #f8f9fa; border-radius: 5px; border: 2px dashed #6c757d;">
                <a href="{{ reset_url }}" class="btn btn-success btn-sm">
                    <i class="fas fa-key"></i> انقر هنا لإعادة تعيين كلمة المرور
                </a>
            </div>
            <small class="text-muted d-block mt-2">
                هذا الرابط متاح للتطوير فقط ولن يظهر في الإنتاج
            </small>
        </div>
        {% else %}
        <div class="alert alert-info text-center">
            <i class="fas fa-envelope fa-2x mb-3"></i>
            <h4>تم إرسال التعليمات</h4>
            <p>إذا كان البريد الإلكتروني مسجلاً في النظام، ستتلقى رسالة تحتوي على تعليمات إعادة تعيين كلمة المرور.</p>
            <small class="text-muted">
                تحقق من صندوق الوارد وصندوق الرسائل المرغوبة
            </small>
        </div>
        {% endif %}
        
        <div class="text-center mt-3">
            <a href="{{ url_for('auth.login') }}" class="btn btn-primary">
                <i class="fas fa-arrow-left"></i> العودة لتسجيل الدخول
            </a>
        </div>
        {% else %}
        <form method="POST" class="auth-form">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
            <div class="form-group">
                <label for="email">البريد الإلكتروني:</label>
                <div class="input-group">
                    <span class="input-group-text">
                        <i class="fas fa-envelope"></i>
                    </span>
                    <input type="email" 
                           id="email" 
                           name="email" 
                           class="form-control" 
                           placeholder="your.email@example.com"
                           required 
                           autofocus>
                </div>
                <small class="form-text text-muted">
                    أدخل عنوان البريد الإلكتروني المرتبط بحسابك
                </small>
            </div>
            
            <button type="submit" class="btn btn-primary btn-block">
                <i class="fas fa-paper-plane"></i> إرسال تعليمات إعادة التعيين
            </button>
        </form>
        
        <div class="auth-footer">
            <div class="text-center">
                <a href="{{ url_for('auth.login') }}" class="text-muted">
                    <i class="fas fa-arrow-left"></i> العودة لتسجيل الدخول
                </a>
            </div>
            
            <div class="mt-3">
                <div class="alert alert-warning">
                    <h6><i class="fas fa-shield-alt"></i> نصائح أمنية:</h6>
                    <ul class="mb-0">
                        <li>تحقق من صندوق الرسائل المرغوبة إذا لم تجد الرسالة</li>
                        <li>الرابط صالح لمدة 24 ساعة فقط</li>
                        <li>لا تشارك رابط إعادة التعيين مع أي شخص</li>
                        <li>إذا لم تطلب إعادة التعيين، تجاهل الرسالة</li>
                    </ul>
                </div>
            </div>
        </div>
        {% endif %}
    </div>
</div>

<style>
.auth-container {
    min-height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    padding: 20px;
}

.auth-card {
    background: white;
    border-radius: 15px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
    width: 100%;
    max-width: 450px;
    overflow: hidden;
}

.auth-header {
    background: linear-gradient(135deg, #1a365d, #2c5282);
    color: white;
    padding: 2rem;
    text-align: center;
}

.auth-header h2 {
    margin: 0 0 1rem 0;
    font-weight: 700;
}

.auth-header p {
    margin: 0;
    opacity: 0.9;
}

.auth-form {
    padding: 2rem;
}

.auth-footer {
    padding: 0 2rem 2rem 2rem;
}

.form-group {
    margin-bottom: 1.5rem;
}

.input-group-text {
    background-color: #f8f9fa;
    border-right: none;
}

.form-control {
    border-left: none;
}

.form-control:focus {
    border-color: #1a365d;
    box-shadow: 0 0 0 0.2rem rgba(26, 54, 93, 0.25);
}

.btn-block {
    width: 100%;
    padding: 12px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.alert {
    border: none;
    border-radius: 10px;
}

.alert-info {
    background: linear-gradient(135deg, #d4edda, #c3e6cb);
    color: #155724;
}

.alert-warning {
    background: linear-gradient(135deg, #fff3cd, #ffeaa7);
    color: #856404;
}

@media (max-width: 768px) {
    .auth-container {
        padding: 10px;
    }
    
    .auth-card {
        margin: 10px;
    }
    
    .auth-header, .auth-form, .auth-footer {
        padding: 1.5rem;
    }
}
</style>
{% endblock %}